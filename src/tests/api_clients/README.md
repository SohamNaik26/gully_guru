# API Client Tests

This directory contains tests for the API clients used by the GullyGuru bot to interact with the API.

## Overview

The tests are organized by client type:

- `test_user_client.py`: Tests for the UserService client
- `test_admin_client.py`: Tests for the AdminService client
- `test_gully_client.py`: Tests for the GullyService client
- `test_client_factory.py`: Tests for the APIClient factory

## Test Fixtures

The tests use the following fixtures:

- `mock_httpx_client`: A mock httpx.AsyncClient for testing API clients
- `mock_response_factory`: A factory function for generating mock responses
- `base_url`: The base URL for API clients
- `user_service`: A UserService instance for testing
- `admin_service`: An AdminService instance for testing
- `gully_service`: A GullyService instance for testing
- `api_client`: An APIClient instance for testing

## Mock Data

The tests use mock data generated by the `MockDataFactory` class in `mocks/data_factory.py`.

## Running the Tests

To run the tests, use pytest:

```bash
# Run all API client tests
pytest src/tests/api_clients/

# Run tests for a specific client
pytest src/tests/api_clients/test_user_client.py

# Run a specific test
pytest src/tests/api_clients/test_user_client.py::TestUserService::test_get_user
```

## Test Coverage

The tests cover the following aspects of the API clients:

- Basic functionality (get, create, update, delete)
- Error handling (not found, invalid data, network errors)
- Edge cases (empty results, etc.)

## Adding New Tests

When adding new tests, follow these guidelines:

1. Use the existing fixtures where possible
2. Mock all external dependencies
3. Test both success and error cases
4. Follow the naming convention: `test_<method_name>_<scenario>`
5. Add docstrings to all test methods

## Integration with CI

These tests are integrated with the CI pipeline and run automatically on each push to the repository. 